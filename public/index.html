<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>TECH STORE</title>

<link rel="stylesheet" href="style.css">

<style>

/* ğŸ”¥ Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ */

header{
    background:#131921;
    padding:12px 20px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:15px;
    flex-wrap:wrap;
}

.logoBox{
    display:flex;
    align-items:center;
    gap:10px;
    cursor:pointer;
}

.logoBox img{
    width:45px;
}

.logoText{
    color:white;
    font-weight:bold;
    font-size:20px;
}

/* Ø§Ù„Ø¨Ø­Ø« */

.searchBox{
    flex:1;
    max-width:600px;
    display:flex;
}

.searchBox input{
    width:100%;
    padding:10px;
    border:none;
    outline:none;
    border-radius:6px 0 0 6px;
}

.searchBox button{
    background:#febd69;
    border:none;
    padding:10px 15px;
    cursor:pointer;
    border-radius:0 6px 6px 0;
}

/* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */

.headerBtns{
    display:flex;
    align-items:center;
    gap:10px;
}

.cartBtn{
    background:#00c896;
    color:white;
    padding:8px 12px;
    border-radius:6px;
    cursor:pointer;
}

.langBtn{
    background:#232f3e;
    color:white;
    border:none;
    padding:8px 10px;
    cursor:pointer;
    border-radius:6px;
}

.adminBtn{
    background:#37475a;
    color:white;
    padding:8px 10px;
    border-radius:6px;
    text-decoration:none;
}

/* Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */

.products{
    padding:30px;
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:25px;
}

.card{
    background:#0f172a;
    border-radius:12px;
    padding:15px;
    color:white;
    transition:.3s;
}

.card:hover{
    transform:scale(1.03);
}

.card img{
    width:100%;
    height:200px;
    object-fit:contain;
    background:white;
    border-radius:10px;
}

.price{
    color:#00e0a4;
    font-size:20px;
    font-weight:bold;
}

.old{
    text-decoration:line-through;
    color:#aaa;
}

.buy{
    margin-top:10px;
    width:100%;
    padding:10px;
    border:none;
    background:#00c896;
    color:white;
    border-radius:8px;
    cursor:pointer;
}

</style>
</head>

<body style="background:#020617;">


<!-- ğŸ”¥ Ø§Ù„Ù‡ÙŠØ¯Ø± -->
<header>

<div class="logoBox">
<img src="/logo.png">
<div class="logoText">TECH STORE</div>
</div>

<div class="searchBox">
<input id="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬...">
<button onclick="search()">ğŸ”</button>
</div>

<div class="headerBtns">

<div class="cartBtn" onclick="goCart()">
ğŸ›’ <span id="cartCount">0</span>
</div>

<button class="langBtn" onclick="toggleLang()">EN</button>

<a class="adminBtn" href="/admin.html">
Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
</a>

</div>

</header>


<!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
<div class="products" id="products"></div>



<script>

let products=[]
let cart = JSON.parse(localStorage.getItem("cart")) || []
updateCart()

// ğŸ”¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
fetch('/api/products')
.then(res=>res.json())
.then(data=>{
    products=data
    showProducts(products)
})

function showProducts(list){

document.getElementById("products").innerHTML=""

list.forEach(p=>{

let oldPrice = p.discount 
? `<span class="old">${p.price}</span>`
: ""

let newPrice = p.discount
? Math.floor(p.price - (p.price*(p.discount/100)))
: p.price

document.getElementById("products").innerHTML+=`

<div class="card">

<img src="${p.image}">

<h3>${p.name || "Ù…Ù†ØªØ¬ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…"}</h3>

<div>
${oldPrice}
<div class="price">${newPrice} Ø¬Ù†ÙŠÙ‡</div>
</div>

<button class="buy" onclick='addToCart(${JSON.stringify(p)})'>
Ø§Ø¶Ù Ù„Ù„Ø³Ù„Ø©
</button>

</div>

`
})

}

// ğŸ”¥ Ø§Ù„Ø³Ù„Ø©
function addToCart(p){

let found = cart.find(i=>i.id===p.id)

if(found){
found.qty++
}else{
p.qty=1
cart.push(p)
}

localStorage.setItem("cart",JSON.stringify(cart))
updateCart()
alert("ØªÙ…Øª Ø§Ù„Ø§Ø¶Ø§ÙØ© âœ…")

}

function updateCart(){
document.getElementById("cartCount").innerText=
cart.reduce((a,b)=>a+b.qty,0)
}

function goCart(){
location.href="/cart.html"
}


// ğŸ”¥ Ø§Ù„Ø¨Ø­Ø«
function search(){

let val = document.getElementById("search").value

let filtered = products.filter(p=>
p.name.toLowerCase().includes(val.toLowerCase())
)

showProducts(filtered)

}


// ğŸ”¥ Ø§Ù„Ù„ØºØ© (Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ø´ Ø´ÙƒÙ„)
let lang="ar"

function toggleLang(){

lang = lang==="ar" ? "en":"ar"

document.querySelector(".langBtn").innerText=
lang==="ar" ? "EN":"AR"

document.getElementById("search").placeholder=
lang==="ar"
? "Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..."
: "Search product..."

}

</script>

</body>
</html>
