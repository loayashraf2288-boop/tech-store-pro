<!DOCTYPE html>
<html lang="ar">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ADMIN</title>

<style>

body{
margin:0;
font-family:Arial;
background:#07111f;
color:white;
padding:30px;
}

/* LOGIN */

.login{
text-align:center;
margin-top:100px;
}

input,textarea{
width:100%;
padding:12px;
margin:10px 0;
border-radius:8px;
border:none;
}

button{
padding:12px;
border:none;
border-radius:8px;
background:#00ffc3;
cursor:pointer;
}

/* DASHBOARD */

.panel{
display:none;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
gap:20px;
}

.card{
background:#0d1b2a;
padding:20px;
border-radius:12px;
}

.product{
display:flex;
justify-content:space-between;
margin:10px 0;
background:#132238;
padding:10px;
border-radius:8px;
}

img{
width:60px;
border-radius:8px;
}

</style>
</head>

<body>

<!-- LOGIN -->

<div class="login" id="login">

<h1>ğŸ” Admin Login</h1>

<input id="code" placeholder="Password">

<button onclick="login()">Ø¯Ø®ÙˆÙ„</button>

</div>

<!-- PANEL -->

<div class="panel" id="panel">

<h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ğŸ”¥</h1>

<div class="grid">

<!-- ADD -->

<div class="card">

<h2>Ø§Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h2>

<input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">

<input id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±">

<input id="discount" placeholder="Ø§Ù„Ø®ØµÙ… %">

<input id="stock" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">

<textarea id="desc" placeholder="Ø§Ù„ØªÙØ§ØµÙŠÙ„"></textarea>

<input type="file" id="images" multiple>

<button onclick="addProduct()">Ø§Ø¶Ø§ÙØ©</button>

</div>

<!-- PRODUCTS -->

<div class="card">

<h2>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>

<div id="products"></div>

</div>

<!-- ORDERS -->

<div class="card">

<h2>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>

<div id="orders"></div>

</div>

</div>

</div>

<script>

/* LOGIN */

function login(){

fetch("/admin-login",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
code:document.getElementById("code").value
})
})
.then(res=>res.json())
.then(data=>{

if(data.success){

document.getElementById("login").style.display="none";
document.getElementById("panel").style.display="block";

loadProducts();
loadOrders();

}else{

alert("ÙƒÙˆØ¯ ØºÙ„Ø·");

}

});

}

/* ADD PRODUCT */

function addProduct(){

const files=document.getElementById("images").files;

let imgs=[];

for(let i=0;i<files.length;i++){

imgs.push(URL.createObjectURL(files[i]));

}

fetch("/api/products",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({

name:document.getElementById("name").value,
price:+document.getElementById("price").value,
discount:+document.getElementById("discount").value,
stock:+document.getElementById("stock").value,
description:document.getElementById("desc").value,
images:imgs

})
})
.then(()=>{

alert("ØªÙ…Øª Ø§Ù„Ø§Ø¶Ø§ÙØ© ğŸ”¥");
loadProducts();

});

}

/* LOAD PRODUCTS */

function loadProducts(){

fetch("/api/products")
.then(res=>res.json())
.then(data=>{

const box=document.getElementById("products");
box.innerHTML="";

data.forEach(p=>{

box.innerHTML+=`

<div class="product">

<img src="${p.images[0]}">

${p.name}

<button onclick="deleteProduct('${p.id}')">
Ø­Ø°Ù
</button>

</div>

`;

});

});

}

/* DELETE */

function deleteProduct(id){

fetch("/api/products/"+id,{
method:"DELETE"
})
.then(loadProducts);

}

/* ORDERS */

function loadOrders(){

fetch("/api/orders")
.then(res=>res.json())
.then(data=>{

const box=document.getElementById("orders");

data.forEach(o=>{

box.innerHTML+=`

<div class="product">

<div>

${o.name}<br>
${o.phone}<br>
${o.address}

</div>

</div>

`;

});

});

}

</script>

</body>
</html>
