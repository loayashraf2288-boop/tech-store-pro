<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Coupons</title>

<style>

body{
margin:0;
font-family:Arial;
display:flex;
background:#020617;
color:white;
}

/* sidebar */

.sidebar{
width:230px;
background:#0f172a;
height:100vh;
padding:20px;
}

.sidebar h2{
color:#00ffd5;
}

.sidebar a{
display:block;
margin-top:15px;
color:white;
text-decoration:none;
}

/* main */

.main{
flex:1;
padding:30px;
}

.card{
background:#0f172a;
padding:20px;
border-radius:12px;
max-width:500px;
}

input{
width:100%;
padding:12px;
margin-top:10px;
border:none;
border-radius:8px;
}

button{
margin-top:10px;
padding:10px;
border:none;
background:#00c896;
color:white;
border-radius:8px;
cursor:pointer;
}

.coupon{
margin-top:10px;
padding:10px;
background:#020617;
border-radius:8px;
display:flex;
justify-content:space-between;
}

.delete{
background:red;
}

</style>
</head>

<body>

<div class="sidebar">

<h2>TECH STORE</h2>

<a href="dashboard.html">ğŸ  Dashboard</a>
<a href="products.html">ğŸ“¦ Products</a>
<a href="add-product.html">â• Add Product</a>
<a href="orders.html">ğŸ§¾ Orders</a>
<a href="coupons.html">ğŸ·ï¸ Coupons</a>

</div>



<div class="main">

<h1>ğŸ·ï¸ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø®ØµÙ…</h1>

<div class="card">

<input id="code" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…">

<input id="discount" type="number" placeholder="Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… %">

<button onclick="createCoupon()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒÙˆØ¯</button>

</div>

<h2>ÙƒÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</h2>

<div id="list"></div>

</div>



<script>

/* Ø­Ù…Ø§ÙŠØ© */
if(!localStorage.getItem("admin")){
location.href="/admin/login.html";
}


/* ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª */

function loadCoupons(){

fetch("/api/coupons")
.then(res=>res.json())
.then(data=>{

const box=document.getElementById("list");

box.innerHTML="";

data.forEach(c=>{

box.innerHTML+=`

<div class="coupon">

<div>
ğŸ”¥ ${c.code} â€” ${c.discount}%
</div>

<button class="delete" onclick="deleteCoupon('${c.code}')">
Ø­Ø°Ù
</button>

</div>

`;

});

});

}

loadCoupons();



/* Ø¥Ù†Ø´Ø§Ø¡ */

async function createCoupon(){

if(!code.value || !discount.value){

alert("Ø§Ù…Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
return;

}

await fetch("/api/coupons",{

method:"POST",
headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({

code:code.value,
discount:discount.value

})

});

alert("ğŸ”¥ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†");

loadCoupons();

}



/* Ø­Ø°Ù */

async function deleteCoupon(code){

await fetch("/api/coupons/"+code,{
method:"DELETE"
});

loadCoupons();

}

</script>

</body>
</html>
